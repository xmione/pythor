<!DOCTYPE html>
<html>

<head>
  <title>PyThor â€” REPL AI Assistant</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }

    textarea,
    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      font-family: monospace;
      font-size: 14px;
    }

    button {
      padding: 10px 20px;
    }

    pre {
      background-color: #f4f4f4;
      padding: 15px;
      border-radius: 6px;
    }

    label input[type="checkbox"] {
      margin-right: 5px;
    }

    #append_dataset {
      margin-left: 20px;
    }
  </style>

  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>

  <script>
    function toggleAppendCheckbox() {
      const saveCheckbox = document.getElementById("save_to_dataset");
      const appendCheckbox = document.getElementById("append_dataset");
      appendCheckbox.disabled = !saveCheckbox.checked;
    }

    window.onload = toggleAppendCheckbox;
  </script>
</head>

<body>
  <h1>ðŸ¤– PyThor â€” REPL AI Assistant</h1>
  <form method="post">
    <label for="instruction">Enter your instruction:</label>
    <input type="text" id="instruction" name="instruction" value="{{ user_input }}">

    <label for="code">Add accompanying code snippet (optional):</label>
    <textarea id="code" name="code" rows="10" placeholder="Paste code here...">{{ user_code }}</textarea>

    <label>
      <input type="checkbox" id="save_to_dataset" name="save_to_dataset" onchange="toggleAppendCheckbox()">
      Save code to dataset
    </label>

    <br><br>

    <button type="submit" name="action" value="generate">Generate</button>
    <button type="submit" name="action" value="crawl">Crawl</button>
  </form>

  {% if code_status %}
  <div style="white-space: pre-line; margin-top: 1em;">
    <strong>Status:</strong><br>
    {{ code_status }}
  </div>
  {% endif %}

  {% if response %}
  <h3>Generated Code:</h3>
  <pre class="language-python"><code class="language-python">{{ response | e }}</code></pre>
  {% endif %}

</body>

</html>
